<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Article Api Project</title>
    <link rel="stylesheet" href="./style.css">
</head>

<body>
    <nav>
        <div class="navbar obj-width">
            <a href="index.html" class="logo">Articles !</a>

            <div class="search-container">
                <input type="text" placeholder="Search news here..." id="search-input">
                <button id="search-button">Search</button>
            </div>
        </div>
    </nav>

    <main id="blog-container">
        <!-- <div class="blog-card">
            <img src="https://placehold.co/600x400" alt="">
            <h2>This is a title</h2>
            <p>Lorem ipsum dolor sit amet consectetur, adipisicing elit. Quae, laudantium ducimus. Hic, cupiditate eveniet ratione dicta recusandae et, amet iure earum animi suscipit eius! Placeat consequatur laborum aliquam eveniet aliquid?</p>
        </div>
        <div class="blog-card">
            <img src="https://placehold.co/600x400" alt="">
            <h2>This is a title</h2>
            <p>Lorem ipsum dolor sit amet consectetur, adipisicing elit. Quae, laudantium ducimus. Hic, cupiditate eveniet ratione dicta recusandae et, amet iure earum animi suscipit eius! Placeat consequatur laborum aliquam eveniet aliquid?</p>
        </div>
        <div class="blog-card">
            <img src="https://placehold.co/600x400" alt="">
            <h2>This is a title</h2>
            <p>Lorem ipsum dolor sit amet consectetur, adipisicing elit. Quae, laudantium ducimus. Hic, cupiditate eveniet ratione dicta recusandae et, amet iure earum animi suscipit eius! Placeat consequatur laborum aliquam eveniet aliquid?</p>
        </div>
        <div class="blog-card">
            <img src="https://placehold.co/600x400" alt="">
            <h2>This is a title</h2>
            <p>Lorem ipsum dolor sit amet consectetur, adipisicing elit. Quae, laudantium ducimus. Hic, cupiditate eveniet ratione dicta recusandae et, amet iure earum animi suscipit eius! Placeat consequatur laborum aliquam eveniet aliquid?</p>
        </div>
        <div class="blog-card">
            <img src="https://placehold.co/600x400" alt="">
            <h2>This is a title</h2>
            <p>Lorem ipsum dolor sit amet consectetur, adipisicing elit. Quae, laudantium ducimus. Hic, cupiditate eveniet ratione dicta recusandae et, amet iure earum animi suscipit eius! Placeat consequatur laborum aliquam eveniet aliquid?</p>
        </div> -->

    </main>


    <script>

        const apiKey = '84f057d47fb34341927dadd2c19422c6';

        const blogContainer = document.getElementById("blog-container");

        const searchField = document.getElementById('search-input');
        const searchButton = document.getElementById('search-button');


        async function fetchRandomNews() {
            try {
                const apiUrl = `https://newsapi.org/v2/top-headlines?country=us&pageSize=20&apiKey=${apiKey}`;
                const response = await fetch(apiUrl);
                const data = await response.json();
                return data.articles;


            } catch (error) {
                console.error("Error fetching randow news", error);
                return [];

            }
        }
        searchButton.addEventListener('click', async () => {
            const Query = searchField.value.trim()
            if (Query !== "") {
                try {
                    const articles = await fetchNewsQuery(Query)
                    displayBlogs(articles)

                }
                catch (error) {
                    console.error("Error fetching news by query", error);
                }

            }


        })

        async function fetchNewsQuery(Query) {
            try {
                const apiUrl = `https://newsapi.org/v2/everything?q=${Query}&pageSize=20&apiKey=${apiKey}`;
                const response = await fetch(apiUrl);
                const data = await response.json();
                return data.articles;


            } catch (error) {
                console.error("Error fetching randow news", error);
                return [];

            }

        }

        function displayBlogs(articles) {
            blogContainer.innerHTML = "";
            articles.forEach((article) => {
                const blogCard = document.createElement("div");
                blogCard.classList.add("blog-card");

                const img = document.createElement("img");
                img.src = article.urlToImage || 'default_image_url.jpg';
                img.alt = article.title || 'No title available';

                const title = document.createElement("h2");
                const truncatedTitle = article.title && article.title.length > 30
                    ? article.title.slice(0, 30) + "..."
                    : article.title || 'No title available';
                title.textContent = truncatedTitle;

                const description = document.createElement("p");
                const truncatedDescription = article.description && article.description.length > 100
                    ? article.description.slice(0, 100) + "..."
                    : article.description || 'No description available';
                description.textContent = truncatedDescription;

                blogCard.appendChild(img);
                blogCard.appendChild(title);
                blogCard.appendChild(description);

                blogCard.addEventListener("click", () => {
                    window.open(article.url, "_blank");
                });

                blogContainer.appendChild(blogCard);
            });
        }

        (async () => {

            try {
                const articles = await fetchRandomNews();
                displayBlogs(articles);


            } catch (error) {
                console.error("Error fetching random news", error);

            }
        })();
    </script>
</body>

</html>